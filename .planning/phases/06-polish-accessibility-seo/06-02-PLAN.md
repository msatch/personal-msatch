---
phase: 06-polish-accessibility-seo
plan: 02
type: execute
wave: 2
depends_on:
  - 06-01
files_modified:
  - src/styles/globals.css
  - src/app/[locale]/layout.tsx
  - src/hooks/use-in-view.ts
  - src/components/ui/scroll-reveal.tsx
  - src/app/[locale]/page.tsx
  - src/app/[locale]/bio/page.tsx
  - src/app/[locale]/services/page.tsx
  - src/components/home/hero-section.tsx
  - src/components/home/cta-band.tsx
  - src/components/home/services-preview.tsx
  - src/components/services/services-cta.tsx
  - messages/es.json
  - messages/en.json
autonomous: true
requirements:
  - DES-05
  - TECH-06
  - TECH-09

must_haves:
  truths:
    - "CTA buttons show enhanced hover states with subtle scale and shadow"
    - "Page sections below the fold animate in as the user scrolls"
    - "Users who prefer reduced motion see no animations"
    - "Keyboard users see visible focus indicators on all interactive elements"
    - "A skip-to-content link appears when tabbing from the top of the page"
    - "First Load JS is under 100 KB per page as reported by npm run build"
  artifacts:
    - path: "src/styles/globals.css"
      provides: "Global focus-visible indicators, prefers-reduced-motion rules"
      contains: "focus-visible"
    - path: "src/hooks/use-in-view.ts"
      provides: "IntersectionObserver hook for scroll detection"
      contains: "IntersectionObserver"
    - path: "src/components/ui/scroll-reveal.tsx"
      provides: "Scroll reveal wrapper component"
      contains: "ScrollReveal"
    - path: "src/app/[locale]/layout.tsx"
      provides: "Skip-to-content link and main id"
      contains: "skip"
  key_links:
    - from: "src/components/ui/scroll-reveal.tsx"
      to: "src/hooks/use-in-view.ts"
      via: "import useInView hook"
      pattern: "use-in-view"
    - from: "src/app/[locale]/page.tsx"
      to: "src/components/ui/scroll-reveal.tsx"
      via: "ScrollReveal wrapping page sections"
      pattern: "ScrollReveal"
    - from: "src/styles/globals.css"
      to: "All interactive elements"
      via: "Global focus-visible CSS rule"
      pattern: "focus-visible"
---

<objective>
Add micro-interactions, accessibility improvements, and verify performance.

Purpose: Enhance the user experience with subtle hover states and scroll reveals (DES-05), ensure the site meets WCAG AA accessibility standards with keyboard navigation and focus indicators (TECH-06), and verify LCP performance on mobile (TECH-09).

Output: Enhanced CTA hover states, scroll reveal animations on page sections, global focus-visible indicators, skip-to-content link, prefers-reduced-motion support, and verified build performance.
</objective>

<execution_context>
@C:/Users/matia/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/matia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-polish-accessibility-seo/06-RESEARCH.md
@.planning/phases/06-polish-accessibility-seo/06-01-SUMMARY.md

@src/styles/globals.css
@src/app/[locale]/layout.tsx
@src/app/[locale]/page.tsx
@src/components/home/hero-section.tsx
@src/components/home/cta-band.tsx
@src/components/home/services-preview.tsx
@src/components/services/services-cta.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Accessibility foundations -- focus indicators, skip-to-content, reduced motion</name>
  <files>
    src/styles/globals.css
    src/app/[locale]/layout.tsx
    messages/es.json
    messages/en.json
  </files>
  <action>
    1. Add global focus-visible and reduced-motion styles to `src/styles/globals.css` inside the existing `@layer base` block:

    ```css
    /* Focus indicators for keyboard navigation (TECH-06) */
    *:focus-visible {
      outline: 2px solid var(--color-accent);
      outline-offset: 2px;
    }

    /* Remove default focus ring for mouse users */
    :focus:not(:focus-visible) {
      outline: none;
    }

    /* Respect reduced motion preferences (TECH-06, DES-05) */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }
    ```

    Place these AFTER the existing touch-friendly tap targets rule, still inside `@layer base`.

    2. Add skip-to-content link to `src/app/[locale]/layout.tsx`:

    - Add a translation key `skipToContent` under `common` namespace in both es.json ("Ir al contenido principal") and en.json ("Skip to main content")
    - In the layout component, add a visually-hidden skip link as the FIRST child inside `<body>`, BEFORE `<NextIntlClientProvider>`. Since this layout is a Server Component, use `getTranslations` (already imported) to get the text:

    ```tsx
    const tCommon = await getTranslations({ locale, namespace: 'common' });
    ```

    Then render before NextIntlClientProvider:
    ```tsx
    <a
      href="#main-content"
      className="sr-only focus:not-sr-only focus:fixed focus:top-4 focus:left-4 focus:z-[100] focus:px-4 focus:py-2 focus:bg-accent focus:text-white focus:rounded-md focus:text-sm focus:font-medium"
    >
      {tCommon('skipToContent')}
    </a>
    ```

    - Add `id="main-content"` to the existing `<main>` element (currently `<main className="flex-1">` becomes `<main id="main-content" className="flex-1">`).

    IMPORTANT: The locale layout is a Server Component (async function). Use `getTranslations` (server-side), NOT `useTranslations`.
    IMPORTANT: The skip link must be OUTSIDE `NextIntlClientProvider` but still has access to translations because it uses the server-side `getTranslations` directly.
  </action>
  <verify>
    Run `npm run build` and confirm no build errors. Run `npm run dev`, then:
    1. Press Tab on any page -- a "Skip to main content" / "Ir al contenido principal" link should appear at top-left
    2. Press Enter on the skip link -- focus should jump to main content
    3. Tab through the page -- all links and buttons should show a visible accent-colored focus ring
    4. Verify focus ring does NOT appear on mouse click (only keyboard)
  </verify>
  <done>
    All interactive elements show visible accent-colored focus rings on keyboard navigation. Skip-to-content link appears for keyboard users. Users who prefer reduced motion have all animations and transitions effectively disabled.
  </done>
</task>

<task type="auto">
  <name>Task 2: Scroll reveal animations and enhanced CTA hover states</name>
  <files>
    src/hooks/use-in-view.ts
    src/components/ui/scroll-reveal.tsx
    src/app/[locale]/page.tsx
    src/app/[locale]/bio/page.tsx
    src/app/[locale]/services/page.tsx
    src/components/home/hero-section.tsx
    src/components/home/cta-band.tsx
    src/components/home/services-preview.tsx
    src/components/services/services-cta.tsx
  </files>
  <action>
    1. Create `src/hooks/use-in-view.ts` -- a custom hook wrapping IntersectionObserver:

    ```typescript
    'use client';

    import { useEffect, useRef, useState } from 'react';

    export function useInView(options?: IntersectionObserverInit) {
      const ref = useRef<HTMLDivElement>(null);
      const [isInView, setIsInView] = useState(false);

      useEffect(() => {
        const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        if (prefersReducedMotion) {
          setIsInView(true);
          return;
        }

        const element = ref.current;
        if (!element) return;

        const observer = new IntersectionObserver(
          ([entry]) => {
            if (entry.isIntersecting) {
              setIsInView(true);
              observer.unobserve(element);
            }
          },
          { threshold: 0.1, ...options }
        );

        observer.observe(element);
        return () => observer.disconnect();
      }, []);

      return { ref, isInView };
    }
    ```

    2. Create `src/components/ui/scroll-reveal.tsx` -- a wrapper component:

    ```typescript
    'use client';

    import { useInView } from '@/hooks/use-in-view';
    import { cn } from '@/lib/utils';

    type Props = {
      children: React.ReactNode;
      className?: string;
      delay?: number;
    };

    export function ScrollReveal({ children, className, delay = 0 }: Props) {
      const { ref, isInView } = useInView({ threshold: 0.1 });

      return (
        <div
          ref={ref}
          className={cn(
            'transition-all duration-700 ease-out',
            isInView ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-6',
            className
          )}
          style={delay > 0 ? { transitionDelay: `${delay}ms` } : undefined}
        >
          {children}
        </div>
      );
    }
    ```

    3. Wrap page sections with ScrollReveal. Since ScrollReveal is a client component and the page sections are Server Components, the wrapping happens at the PAGE level (where sections are composed), NOT inside each section component.

    In `src/app/[locale]/page.tsx` (home page):
    - Import ScrollReveal at the top
    - Do NOT wrap HeroSection (above the fold, must render immediately)
    - Wrap ProblemSection, ServicesPreview, ProcessSection, and CtaBand each in `<ScrollReveal>`:
    ```tsx
    <HeroSection />
    <ScrollReveal>
      <ProblemSection />
    </ScrollReveal>
    <ScrollReveal delay={100}>
      <ServicesPreview />
    </ScrollReveal>
    <ScrollReveal delay={100}>
      <ProcessSection />
    </ScrollReveal>
    <ScrollReveal>
      <CtaBand />
    </ScrollReveal>
    ```

    In `src/app/[locale]/bio/page.tsx`:
    - Wrap NarrativeSection and SocialProofSection in ScrollReveal (NOT PhotoCredentials which is above the fold)
    - Wrap the CTA band section in ScrollReveal

    In `src/app/[locale]/services/page.tsx`:
    - Wrap ProcessSection, FaqSection, and ServicesCta in ScrollReveal (NOT OfferingsSection which is above the fold)

    IMPORTANT: Do NOT wrap above-the-fold content. Only content that appears below the initial viewport should get scroll reveals.

    4. Enhance CTA button hover states. Update the CTA Link className in these components to add scale and shadow transitions:

    Current pattern: `hover:bg-accent-dark transition-colors`
    Enhanced pattern: `hover:bg-accent-dark hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] transition-all duration-200`

    Apply to:
    - `src/components/home/hero-section.tsx` -- the CTA Link
    - `src/components/home/cta-band.tsx` -- the CTA Link
    - `src/components/services/services-cta.tsx` -- the CTA Link
    - The CTA Link in `src/app/[locale]/bio/page.tsx` (inline CTA band)

    Also enhance service card hover in `src/components/home/services-preview.tsx`:
    Current: `hover:border-accent hover:shadow-md transition-all`
    Enhanced: `hover:border-accent hover:shadow-md hover:-translate-y-1 transition-all duration-200`

    IMPORTANT: Only animate `opacity`, `transform`, and `box-shadow` (compositable properties). Do NOT animate layout properties like width, height, margin, padding.
    IMPORTANT: The `transition-colors` on CTAs must change to `transition-all` to support the scale transform.

    5. Run `npm run build` to check bundle size output. Record the JS bundle size for each page from the build output. Verify the total First Load JS is reasonable (the scroll-reveal component and useInView hook add minimal JS -- about 1-2 KB total). If any page exceeds 100 KB First Load JS, investigate and note in the summary.
  </action>
  <verify>
    Run `npm run build` and confirm:
    1. Build succeeds with no errors
    2. Check build output for page sizes -- verify First Load JS is under 100 KB for each route

    Run `npm run dev` and verify:
    1. Scroll down the home page -- sections fade in as they enter the viewport
    2. Hover over CTA buttons -- they slightly scale up with a shadow
    3. Click CTA buttons -- they slightly scale down (active state)
    4. Hover over service preview cards -- they lift up slightly
    5. Visit bio and services pages -- sections below fold animate in
    6. Enable "Prefer reduced motion" in OS accessibility settings (or browser DevTools rendering tab) -- all animations should be instant/disabled
  </verify>
  <done>
    Scroll reveal animations appear on below-the-fold sections across home, bio, and services pages. CTA buttons have enhanced hover (scale + shadow) and active (scale-down) states. Service cards lift on hover. All animations respect prefers-reduced-motion. Build succeeds and First Load JS is under 100 KB per page.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Tab through the entire site -- all links, buttons, and form fields show visible accent-colored focus rings
3. Skip-to-content link appears on Tab press and jumps to main content
4. Scroll reveals work on home, bio, and services pages for below-the-fold content
5. CTA hover states show scale and shadow enhancement
6. With prefers-reduced-motion enabled, no animations play
7. Build output shows First Load JS under 100 KB per page
</verification>

<success_criteria>
- Focus-visible ring: 2px solid accent color with 2px offset on all interactive elements
- Skip-to-content link: bilingual, appears on Tab, targets #main-content
- Scroll reveals: opacity 0->1 and translate-y 6->0 on sections below the fold
- CTA hovers: scale 1.02 + shadow-lg on hover, scale 0.98 on active
- Reduced motion: all transitions and animations effectively disabled
- Performance: `npm run build` shows First Load JS under 100 KB per page for all routes
</success_criteria>

<output>
After completion, create `.planning/phases/06-polish-accessibility-seo/06-02-SUMMARY.md`
</output>