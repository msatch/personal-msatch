---
phase: 01-foundation-i18n-scaffolding
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/styles/globals.css
  - src/app/[locale]/layout.tsx
  - src/app/[locale]/page.tsx
  - src/app/not-found.tsx
autonomous: true

must_haves:
  truths:
    - "Navigating to /es/ renders a page with Spanish content from translation JSON"
    - "Navigating to /en/ renders a page with English content from translation JSON"
    - "Browser Accept-Language detection routes first-time visitor to correct locale"
    - "Locale preference persists across page refreshes via NEXT_LOCALE cookie"
    - "Design tokens (colors, fonts, spacing) are defined in globals.css via @theme and rendered on the test page"
    - "Page displays correct typography with bold heading hierarchy"
    - "Layout is mobile-first responsive (stacks on mobile, expands on larger viewports)"
    - "Touch targets meet 44x44px minimum"
  artifacts:
    - path: "src/styles/globals.css"
      provides: "Tailwind CSS 4 design tokens via @theme and @theme inline, base styles"
      contains: "@theme"
    - path: "src/app/[locale]/layout.tsx"
      provides: "Root locale layout with fonts, NextIntlClientProvider, generateStaticParams"
      contains: "NextIntlClientProvider"
    - path: "src/app/[locale]/page.tsx"
      provides: "Home page rendering translated content with design token showcase"
      contains: "getTranslations"
    - path: "src/app/not-found.tsx"
      provides: "Global 404 fallback page"
  key_links:
    - from: "src/app/[locale]/layout.tsx"
      to: "src/i18n/routing.ts"
      via: "generateStaticParams uses routing.locales"
      pattern: "routing\\.locales"
    - from: "src/app/[locale]/layout.tsx"
      to: "src/styles/globals.css"
      via: "CSS import for design tokens"
      pattern: "import.*globals"
    - from: "src/app/[locale]/page.tsx"
      to: "messages/*.json"
      via: "getTranslations loads namespace from JSON"
      pattern: "getTranslations"
    - from: "src/styles/globals.css"
      to: "src/app/[locale]/layout.tsx"
      via: "Font CSS variables injected by next/font, consumed by @theme inline"
      pattern: "@theme inline"
---

<objective>
Create the design token system in Tailwind CSS 4, build the [locale] layout with fonts and i18n provider, and create a test page that renders bilingual content from translation files. Wire everything together so navigating to /es/ and /en/ shows locale-specific content with correct typography, accent color, and mobile-first responsive layout.

Purpose: This is the "proof it works" plan -- after this, a developer can see bilingual routing, locale detection, cookie persistence, and design tokens all functioning together. This is the phase success criteria.
Output: A working bilingual page that proves the entire foundation stack (Next.js + Tailwind v4 + next-intl) is correctly integrated.
</objective>

<execution_context>
@C:/Users/matia/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/matia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-i18n-scaffolding/01-RESEARCH.md
@.planning/phases/01-foundation-i18n-scaffolding/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure design tokens in globals.css and create locale layout</name>
  <files>
    src/styles/globals.css
    src/app/[locale]/layout.tsx
    src/app/not-found.tsx
  </files>
  <action>
    1. **src/styles/globals.css** -- Replace the create-next-app defaults with the project's design token system. Move the file from its scaffolded location (likely `src/app/globals.css`) to `src/styles/globals.css`:

       ```css
       @import "tailwindcss";

       /* Static design tokens (DES-01, DES-06) */
       @theme {
         /* === Brand Colors === */
         --color-background: #ffffff;
         --color-foreground: #0a0a0a;
         --color-accent: oklch(0.55 0.15 250);
         --color-accent-light: oklch(0.92 0.05 250);
         --color-accent-dark: oklch(0.40 0.15 250);
         --color-muted: #6b7280;
         --color-muted-foreground: #9ca3af;
         --color-border: #e5e7eb;

         /* === Spacing (base: 0.25rem = 4px) === */
         --spacing: 0.25rem;

         /* === Border Radius === */
         --radius-sm: 0.375rem;
         --radius-md: 0.5rem;
         --radius-lg: 0.75rem;
         --radius-xl: 1rem;
       }

       /* Runtime font tokens from next/font CSS variables (DES-02) */
       @theme inline {
         --font-sans: var(--font-geist-sans);
         --font-mono: var(--font-geist-mono);
       }

       /* Base styles */
       @layer base {
         body {
           @apply bg-background text-foreground font-sans antialiased;
         }

         h1, h2, h3, h4, h5, h6 {
           @apply font-bold tracking-tight text-foreground;
         }

         /* Touch-friendly tap targets (DES-04: min 44x44px) */
         button, a, [role="button"] {
           @apply min-h-[44px] min-w-[44px];
         }
       }
       ```

    2. **src/app/[locale]/layout.tsx** -- Create the root locale layout. Remove the scaffolded `src/app/layout.tsx` and `src/app/page.tsx` (they are replaced by the [locale] variants):

       ```typescript
       import type { Metadata } from 'next';
       import { Geist, Geist_Mono } from 'next/font/google';
       import { NextIntlClientProvider, hasLocale } from 'next-intl';
       import { setRequestLocale, getTranslations } from 'next-intl/server';
       import { notFound } from 'next/navigation';
       import { routing } from '@/i18n/routing';
       import '@/styles/globals.css';

       const geistSans = Geist({
         variable: '--font-geist-sans',
         subsets: ['latin'],
       });

       const geistMono = Geist_Mono({
         variable: '--font-geist-mono',
         subsets: ['latin'],
       });

       type Props = {
         children: React.ReactNode;
         params: Promise<{ locale: string }>;
       };

       export function generateStaticParams() {
         return routing.locales.map((locale) => ({ locale }));
       }

       export async function generateMetadata({ params }: { params: Promise<{ locale: string }> }): Promise<Metadata> {
         const { locale } = await params;
         const t = await getTranslations({ locale, namespace: 'metadata' });
         return {
           title: t('title'),
           description: t('description'),
         };
       }

       export default async function LocaleLayout({ children, params }: Props) {
         const { locale } = await params;
         if (!hasLocale(routing.locales, locale)) {
           notFound();
         }
         setRequestLocale(locale);

         return (
           <html lang={locale}>
             <body className={`${geistSans.variable} ${geistMono.variable}`}>
               <NextIntlClientProvider>
                 {children}
               </NextIntlClientProvider>
             </body>
           </html>
         );
       }
       ```

       CRITICAL Next.js 16 notes:
       - `params` is a Promise -- MUST await it
       - `setRequestLocale(locale)` is required for static generation
       - `generateStaticParams` returns all locales for pre-rendering
       - Import globals.css from `@/styles/globals.css` (not the old location)

    3. **src/app/not-found.tsx** -- Global 404 fallback (minimal for Phase 1):
       ```typescript
       export default function NotFound() {
         return (
           <html>
             <body>
               <main className="min-h-screen flex items-center justify-center">
                 <div className="text-center">
                   <h1 className="text-4xl font-bold">404</h1>
                   <p className="mt-4 text-muted">Page not found</p>
                 </div>
               </main>
             </body>
           </html>
         );
       }
       ```

    4. Delete the scaffolded files that are now replaced:
       - Remove `src/app/layout.tsx` (replaced by `src/app/[locale]/layout.tsx`)
       - Remove `src/app/page.tsx` (replaced by `src/app/[locale]/page.tsx`)
       - Remove `src/app/globals.css` if it exists (replaced by `src/styles/globals.css`)
       - Keep `src/app/` directory itself (it contains [locale]/ and not-found.tsx)
  </action>
  <verify>
    - `ls src/app/[locale]/layout.tsx` confirms file exists
    - `cat src/app/[locale]/layout.tsx` contains `NextIntlClientProvider`, `generateStaticParams`, `await params`
    - `cat src/styles/globals.css` contains `@theme` block with `--color-accent` and `@theme inline` with `--font-sans`
    - `ls src/app/layout.tsx` returns "not found" (deleted, replaced by [locale] variant)
    - `ls src/app/page.tsx` returns "not found" (deleted, replaced by [locale] variant)
    - `ls src/app/not-found.tsx` confirms global 404 exists
  </verify>
  <done>
    Design tokens are defined in globals.css via @theme (colors, spacing, radius) and @theme inline (fonts). The [locale] layout loads Geist fonts, wraps children in NextIntlClientProvider, sets the HTML lang attribute, and uses generateStaticParams for static generation. The old scaffolded layout/page files are removed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create bilingual test page and verify full i18n stack</name>
  <files>
    src/app/[locale]/page.tsx
  </files>
  <action>
    1. **src/app/[locale]/page.tsx** -- Create the home page that proves the entire stack works. This is a test page that demonstrates: translated content from JSON files, design token usage (accent color, typography hierarchy, spacing), mobile-first responsive layout, and locale switching.

       ```typescript
       import { getTranslations, setRequestLocale } from 'next-intl/server';
       import { routing } from '@/i18n/routing';
       import { Link } from '@/i18n/navigation';

       export function generateStaticParams() {
         return routing.locales.map((locale) => ({ locale }));
       }

       export default async function HomePage({ params }: { params: Promise<{ locale: string }> }) {
         const { locale } = await params;
         setRequestLocale(locale);

         const t = await getTranslations('home.hero');
         const tCommon = await getTranslations('common');
         const tNav = await getTranslations('common.nav');

         const otherLocale = locale === 'es' ? 'en' : 'es';

         return (
           <main className="min-h-screen flex flex-col">
             {/* Temporary locale switch link (will be replaced by nav in Phase 2) */}
             <div className="flex justify-end p-4">
               <Link
                 href="/"
                 locale={otherLocale}
                 className="inline-flex items-center justify-center px-4 py-2 text-sm font-medium rounded-md border border-border hover:bg-accent-light transition-colors"
               >
                 {otherLocale.toUpperCase()}
               </Link>
             </div>

             {/* Hero section - demonstrates typography hierarchy and accent color */}
             <section className="flex-1 flex flex-col items-center justify-center px-4 py-16 md:py-24">
               <h1 className="text-3xl md:text-5xl lg:text-6xl font-bold tracking-tight text-center max-w-4xl">
                 {t('title')}
               </h1>
               <p className="mt-6 text-base md:text-lg lg:text-xl text-muted text-center max-w-2xl">
                 {t('subtitle')}
               </p>
               <button
                 className="mt-8 px-6 py-3 bg-accent text-white font-semibold rounded-lg hover:bg-accent-dark transition-colors text-base md:text-lg"
               >
                 {tCommon('cta')}
               </button>
             </section>

             {/* Navigation links preview - demonstrates translation of nav items */}
             <nav className="border-t border-border py-8 px-4">
               <div className="max-w-4xl mx-auto flex flex-col md:flex-row items-center justify-center gap-4 md:gap-8">
                 <span className="text-sm text-muted">{tCommon('language')}: {locale.toUpperCase()}</span>
                 <span className="hidden md:inline text-border">|</span>
                 <div className="flex gap-4">
                   <span className="text-sm font-medium">{tNav('home')}</span>
                   <span className="text-sm font-medium">{tNav('bio')}</span>
                   <span className="text-sm font-medium">{tNav('services')}</span>
                   <span className="text-sm font-medium">{tNav('contact')}</span>
                 </div>
               </div>
             </nav>
           </main>
         );
       }
       ```

       Design requirements demonstrated:
       - **DES-01**: White background, black text, accent color CTA button
       - **DES-02**: Bold typography with h1 hierarchy (3xl -> 5xl -> 6xl responsive)
       - **DES-03**: Mobile-first responsive (text-3xl default, md:text-5xl, lg:text-6xl)
       - **DES-04**: Touch-friendly CTA button (px-6 py-3 = well over 44px)
       - **I18N-01**: Both languages render from JSON
       - **I18N-02**: URL-based /es/ and /en/ routes
       - **I18N-03**: All text from translation files, zero hardcoded strings

    2. Verify the full i18n routing stack end-to-end:
       - Start `npm run dev`
       - Visit `http://localhost:3000/` -- should redirect to `/es/` (defaultLocale)
       - Confirm Spanish content renders: hero title, subtitle, CTA in Spanish
       - Click the "EN" locale switch link
       - Confirm URL changes to `/en/` and content switches to English
       - Refresh the page -- should stay on `/en/` (cookie persistence via NEXT_LOCALE)
       - Check that the accent-colored CTA button renders with the correct background color
       - Resize to mobile viewport -- confirm text sizes are smaller, layout stacks vertically

    3. If proxy.ts is not being picked up (no redirect from `/` to `/es/`):
       - Try moving `src/proxy.ts` to project root `proxy.ts` and update the import path for routing
       - Check Next.js console for any proxy-related warnings
       - Verify the matcher regex is correct
  </action>
  <verify>
    - `npm run dev` starts without errors
    - Visiting http://localhost:3000/ redirects to /es/ (Accept-Language detection or default)
    - /es/ page shows "Convierto objetivos de negocio en ejecucion tecnica" (Spanish hero title)
    - /en/ page shows "Converting business goals into technical execution" (English hero title)
    - /es/ page shows accent-colored CTA button with text "Agenda tu diagnostico de 45 min"
    - Browser tab title shows locale-specific metadata (from generateMetadata)
    - After switching to /en/ and refreshing, page stays on /en/ (cookie persistence)
    - On mobile viewport, text is smaller and layout is single-column
    - `npm run build` completes without errors and shows pages as static (circle symbol)
  </verify>
  <done>
    The bilingual test page renders locale-specific content from translation JSON files at /es/ and /en/. Browser Accept-Language detection redirects first-time visitors to the correct locale. NEXT_LOCALE cookie persists locale choice across refreshes. Design tokens render correctly: accent color on CTA, bold typography hierarchy, mobile-first responsive layout. All five phase success criteria are met.
  </done>
</task>

</tasks>

<verification>
All Phase 1 success criteria verified:
1. `npm run dev` starts the application and renders a page at localhost -- confirmed
2. /es/ and /en/ render locale-specific content from translation JSON files -- confirmed by reading hero title in both languages
3. Browser language detection routes first-time visitor to correct locale -- proxy.ts with Accept-Language detection
4. Locale preference persists across page refreshes -- NEXT_LOCALE cookie verified by refresh test
5. Design tokens (colors, fonts, spacing) defined in Tailwind config and rendered correctly -- @theme tokens visible in CTA button color, typography hierarchy, responsive layout
</verification>

<success_criteria>
- /es/ renders Spanish content, /en/ renders English content, both from translation JSON files
- Visiting / redirects to /es/ (default locale for LatAm target market)
- Switching locale and refreshing maintains the chosen locale (cookie persistence)
- Accent color renders on CTA button, typography uses Geist font with bold hierarchy
- Mobile viewport shows smaller text and stacked layout (mobile-first responsive)
- `npm run build` produces static pages for both locales
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-i18n-scaffolding/01-02-SUMMARY.md`
</output>
